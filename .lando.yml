name: d-8-cwi
recipe: pantheon
config:
  framework: drupal8
  env: dev
  site: d8cwi
  id: f3a5f3c2-9f22-48ac-b6b3-99d9f384a163
  drush: 9.7.2
  php: '7.3'
  #user with phpstorm for debugging, leaving on will slow down site, requires a Lando rebuild
  #xdebug: true
events:
  post-db-import:
    - appserver: cd $LANDO_MOUNT && composer install
services:
  appserver:
    overrides:
      sysctls:
        net.ipv4.tcp_keepalive_time: '72000'
        #try removing keepalive after migrations are complete, causing timeouts during field_instance migration tasks
      environment:
        BEHAT_PARAMS: >-
          {"extensions" : {"Behat\\MinkExtension" : {"base_url" :
          "http://nginx/"}, "Drupal\\DrupalExtension" : {"drush" :   {
          "root":  "/app/web" }}}}
        #xdebug config for CLI
        PHP_IDE_CONFIG: "serverName=localhost"
    config:
      conf: config/php/php.ini
  d7db:
    type: mariadb
    creds:
      user: drupal7db
      password: drupal7db
      database: drupal7db
    portforward: true
tooling:
  phplint:
    service: appserver
    cmd: /app/vendor/bin/phplint
  phpcs:
    service: appserver
    cmd: /app/vendor/bin/phpcs
  phpunit:
    service: appserver
    cmd: /app/vendor/bin/phpunit
  behat:
    service: appserver
    cmd: /app/vendor/bin/behat
  drush:
    cmd:
      - "drush --root=/app/web"